<app-content>
  <section class="section" *ngIf="hasReportReadPermission">

    <div class="row">
      <div class="col-12 col-md-12 col-lg-12">
        <div class="ibox ">
          <div class="ibox-title" style="margin-top: 5px;">
            <div>
              <a class="btn btn-outline btn-primary dim pull-right" [routerLink]="['/add-edit-report']" *ngIf="hasAddReportPermission">
                <i class="fa fa-fw fa-plus-square"></i> Add New Report
              </a>
            </div>
            <h3>Report List</h3>
          </div>

          <div class="ibox-content">
            <p-table #dt [columns]="cols" [value]=" reports " [lazy]="true" (onLazyLoad)="loadReport($event)"
                     [totalRecords]="totalRecords" [paginator]="true" [rowsPerPageOptions]="[10,15,20,25,50,100]" [rows]="10"
                     [showLoader]="true" sortField="name" [loading]="loading" [sortOrder]="1">

              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                    {{col.header}}
                  </th>
                  <th style="width: 100px;">&nbsp;</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr>
                  <td>
                    {{getNavigationPropertyData(rowData, 'name')}}
                  </td>
                  <td>
                    {{getNavigationPropertyData(rowData, 'description')}}
                  </td>
                  <td>
                    {{getNavigationPropertyData(rowData, 'reportUrl')}}
                  </td>
                  <td style="width: 50px;">
                    <div class="dropdown d-inline">
                      <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" *ngIf="hasRunReportPermission || hasViewReportPermission || hasEditReportPermission"
                              id="dropdownmenubutton2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="fa fa-asterisk"></i>
                      </button>
                      <div class="dropdown-menu dropdown-menu-right">
                        <a style="cursor: pointer;" class="dropdown-item has-icon" *ngIf="hasRunReportPermission"
                           (click)="runReport(rowData.reportUrl)">
                          <i class="fa fa-renren"></i>
                          Run
                        </a>
                        <a style="cursor: pointer;" class="dropdown-item has-icon" *ngIf="hasViewReportPermission"
                           [routerLink]="['/view-report/', rowData.id]">
                          <i class="fa fa-street-view"></i>
                          View Report
                        </a>
                        <a style="cursor: pointer;" class="dropdown-item has-icon" *ngIf="hasEditReportPermission"
                           [routerLink]="['/report-edit/', rowData.id]">
                          <i class="fa fa-edit"></i>
                          Edit
                        </a>
                      </div>
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>
      <div>
      </div>
    </div>


  </section>
</app-content>
